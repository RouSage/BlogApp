$(document).ready(function(){var n={};n.GridManager={};n.GridManager.postsGrid=$("#tablePosts").jqGrid({url:"Posts",datatype:"json",mtype:"GET",height:"auto",colNames:["ID","Title","Description","Content","UrlSlug","Published","PostedOn","Modified","CategoryID","Category","Tags"],colModel:[{name:"ID",index:"ID",hidden:!0,key:!0},{name:"Title",index:"Title",width:250,sortable:!0,editable:!0,editoptions:{size:43,maxlength:500},editrules:{required:!0}},{name:"Description",index:"Description",width:250,sortable:!1,hidden:!0,editable:!0,edittype:"textarea",editoptions:{rows:"10",cols:"100"},editrules:{custom:!0,custom_func:function(n,t){return(n=tinymce.get("Description").getContent(),n)?[!0,""]:[!1,t+": Field is required"]},edithidden:!0}},{name:"Content",index:"Content",width:250,sortable:!1,hidden:!0,editable:!0,edittype:"textarea",editoptions:{rows:"40",cols:"100"},editrules:{custom:!0,custom_func:function(n,t){return(n=tinymce.get("Content").getContent(),n)?[!0,""]:[!1,t+": Field is required"]},edithidden:!0}},{name:"UrlSlug",index:"UrlSlug",width:200,sortable:!1,editable:!0,editoptions:{size:43,maxlength:50},editrules:{required:!0}},{name:"Published",index:"Published",width:100,align:"center",editable:!0,edittype:"checkbox",editoptions:{value:"true:false",defaultValue:"false"}},{name:"PostedOn",index:"PostedOn",width:150,align:"center",sorttype:"date",datefmt:"m.d.Y"},{name:"Modified",index:"Modified",width:150,align:"center",sorttype:"date",datefmt:"m.d.Y"},{name:"Category.ID",hidden:!0,editable:!0,edittype:"select",editoptions:{style:"width: 250px;",dataUrl:"GetCategoriesHtml"},editrules:{required:!0,edithidden:!0}},{name:"Category.Name",index:"Category",width:150},{name:"Tags",index:"Tags",width:150,editable:!0,edittype:"select",editoptions:{style:"width: 250px;",dataUrl:"GetTagsHtml",multiple:!0},editrules:{required:!0}}],toppager:!0,pager:"#pagerPosts",rowNum:10,rowList:[10,20,30],rownumbers:!0,rownumWidth:40,sortname:"PostedOn",sortorder:"desc",viewrecords:!0,caption:"Posts",jsonReader:{repeatitems:!1},afterInsertRow:function(n,t){var r=t.Tags,i="";$.each(r,function(n,t){i&&(i+=", ");i+=t.Name});$(this).setRowData(n,{Tags:i})}});var i=function(){tinymce.init({selector:"#Description",theme:"modern",branding:!1,resize:!1,statusbar:!1,menubar:!1,browser_spellcheck:!0,contextmenu:!1,plugins:"lists advlist link anchor image searchreplace help code hr visualblocks visualchars table textcolor charmap",toolbar:["bold italic underline strikethrough code | alignleft aligncenter alignright alignjustify | visualblocks visualchars removeformat | styleselect formatselect","undo redo | forecolor backcolor | bullist numlist | indent outdent | link unlink | anchor searchreplace help","fontsizeselect | hr table image charmap | subscript superscript"],link_context_toolbar:!0,link_title:!1,code_dialog_height:300,code_dialog_width:600});tinymce.init({selector:"#Content",theme:"modern",branding:!1,resize:!1,statusbar:!1,menubar:!1,browser_spellcheck:!0,contextmenu:!1,plugins:"lists advlist link anchor image searchreplace help code hr visualblocks visualchars table textcolor charmap",toolbar:["bold italic underline strikethrough code | alignleft aligncenter alignright alignjustify | visualblocks visualchars removeformat | styleselect formatselect","undo redo | forecolor backcolor | bullist numlist | indent outdent | link unlink | anchor searchreplace help","fontsizeselect | hr table image charmap | subscript superscript"],link_context_toolbar:!0,link_title:!1,code_dialog_height:300,code_dialog_width:600})},t=function(n){var t=$.parseJSON(n.responseText);return t?[t.success,t.message,t.id]:[!1,"Failed to get result from server.",null]},r=function(n){var t=$("#tablePosts").getRowData($("#tablePosts").getGridParam("selrow"));return t.PostedOn&&(n.PostedOn=t.PostedOn),n.Description=tinymce.get("Description").getContent(),n.Content=tinymce.get("Content").getContent(),[!0]},u=function(){tinymce.remove("#Description");tinymce.remove("#Content")};n.GridManager.postsNavGrid=$("#tablePosts").navGrid("#pagerPosts",{cloneToTop:!0,search:!1,addtitle:"Add new post",edittitle:"Edit selected post",deltitle:"Delete selected post",alerttext:"Please, select row"},{url:"EditPost",editCaption:"Edit Post",processData:"Saving...",width:1e3,closeAfterEdit:!0,closeOnEscape:!0,afterShowForm:i,onClose:u,beforeSubmit:r,afterSubmit:t},{url:"AddPost",addCaption:"Add Post",processData:"Saving...",width:1e3,closeAfterAdd:!0,closeOnEscape:!0,afterShowForm:i,onClose:u,beforeSubmit:r,afterSubmit:t},{url:"DeletePost",caption:"Delete Post",processData:"Saving...",msg:"Delete the Post?",closeOnEscape:!0,afterSubmit:t});n.GridManager.categoriesGrid=$("#tableCategories").jqGrid({url:"Categories",datatype:"json",mtype:"GET",height:"auto",colNames:["ID","Name","UrlSlug","Frequence"],colModel:[{name:"ID",index:"ID",hidden:!0,sorttype:"int",key:!0,editable:!1,editoptions:{readonly:!0}},{name:"Name",index:"Name",width:200,sortable:!0,editable:!0,edittype:"text",editoptions:{size:30,maxlength:500},editrules:{required:!0}},{name:"UrlSlug",index:"UrlSlug",width:200,sortable:!1,editable:!0,edittype:"text",editoptions:{size:30,maxlength:500},editrules:{required:!0}},{name:"Frequence",index:"Frequence",width:100,sortable:!0,editable:!1,edittype:"int",editoptions:{readonly:!0}}],toppager:!0,pager:"#pagerCategories",rownumbers:!0,rownumWidth:40,rowNum:500,sortname:"Name",viewrecords:!0,caption:"Categories",loadonce:!0,jsonReader:{repeatitems:!1}});n.GridManager.categoriesNavGrid=$("#tableCategories").navGrid("#pagerCategories",{cloneToTop:!0,search:!1,addtitle:"Add new category",edittitle:"Edit selected category",deltitle:"Delete selected category",alerttext:"Please, select row"},{url:"EditCategory",width:400,editCaption:"EditCategory",processData:"Saving...",closeAfterEdit:!0,closeOnEscape:!0,afterSubmit:function(n){var t=$.parseJSON(n.responseText);return t?($("#tableCategories").jqGrid("setGridParam",{datatype:"json"}),[t.success,t.message,t.id]):[!1,"Failed to get result from server.",null]}},{url:"AddCategory",width:400,addCaption:"Add Category",processData:"Saving...",closeAfterAdd:!0,closeOnEscape:!0,afterSubmit:function(n){var t=$.parseJSON(n.responseText);return t?($("#tableCategories").jqGrid("setGridParam",{datatype:"json"}),[t.success,t.message,t.id]):[!1,"Failed to get result from server.",null]}},{url:"DeleteCategory",caption:"Delete Category",processData:"Saving...",width:450,msg:"Delete the category? This will delete all the posts belongs to this category as well.",closeOnEscape:!0,afterSubmit:t});n.GridManager.tagsGrid=$("#tableTags").jqGrid({url:"Tags",datatype:"json",mtype:"GET",height:"auto",colNames:["ID","Name","UrlSlug"],colModel:[{name:"ID",index:"ID",hidden:!0,sorttype:"int",key:!0,editable:!1,editoptions:{readonly:!0}},{name:"Name",index:"Name",width:200,sortable:!0,editable:!0,edittype:"text",editoptions:{size:30,maxlength:50},editrules:{required:!0}},{name:"UrlSlug",index:"UrlSlug",width:200,sortable:!1,editable:!0,edittype:"text",editoptions:{size:30,maxlength:50},editrules:{required:!0}}],toppager:!0,pager:"#pagerTags",rownumbers:!0,rownumWidth:40,rowNum:500,sortname:"Name",viewrecords:!0,caption:"Tags",loadonce:!0,jsonReader:{repeatitems:!1}});n.GridManager.tagsNavGrid=$("#tableTags").navGrid("#pagerTags",{cloneToTop:!0,search:!1,addtitle:"Add new tag",edittitle:"Edit selected tag",deltitle:"Delete selected tag",alerttext:"Please, select row"},{url:"EditTag",width:400,editCaption:"Edit Tag",processData:"Saving...",closeAfterEdit:!0,closeOnEscape:!0,afterSubmit:function(n){var t=$.parseJSON(n.responseText);return t?($("#tableTags").jqGrid("setGridParam",{datatype:"json"}),[t.success,t.message,t.id]):[!1,"Failed to get result from server.",null]}},{url:"AddTag",width:400,addCaption:"Add Tag",processData:"Saving...",closeAfterAdd:!0,closeOnEscape:!0,afterSubmit:function(n){var t=$.parseJSON(n.responseText);return t?($("#tableTags").jqGrid("setGridParam",{datatype:"json"}),[t.success,t.message]):[!1,"Failed to get result from server.",null]}},{url:"DeleteTag",caption:"Delete Tag",processData:"Saving...",width:400,msg:"Delete the tag? This will delete all the posts belong to this tag as well.",closeOnEscape:!0,afterSubmit:t})});